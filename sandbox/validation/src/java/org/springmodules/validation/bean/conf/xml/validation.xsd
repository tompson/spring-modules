<?xml version="1.0" encoding="UTF-8"?>
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema"
           elementFormDefault="qualified"
           targetNamespace="http://www.springmodules.org/validation/bean"
           xmlns:bean="http://www.springmodules.org/validation/bean">

    <!-- Basic Structure Element Definitions -->

    <xs:element name="validator" type="bean:validatorType"/>

    <xs:element name="validation" type="bean:validationType"/>

    <xs:element name="class" type="bean:classType"/>

    <xs:element name="global" type="bean:globalType"/>

    <xs:element name="property" type="bean:propertyType"/>


    <!-- Types -->

    <xs:complexType name="validatorType">
        <xs:attribute name="id" use="required" type="xs:string"/>
        <xs:attribute name="errorCodeConverter" use="optional" type="xs:string"/>
    </xs:complexType>

    <xs:complexType name="validationType">
        <xs:sequence>
            <xs:element ref="bean:class" minOccurs="0" maxOccurs="unbounded"/>
        </xs:sequence>
        <xs:attribute name="package" use="optional"/>
    </xs:complexType>

    <xs:complexType name="classType">
        <xs:sequence>
            <xs:element ref="bean:global" minOccurs="0" maxOccurs="1"/>
            <xs:element ref="bean:property" minOccurs="0" maxOccurs="unbounded"/>
        </xs:sequence>
        <xs:attribute name="name" use="required" type="xs:string"/>
        <xs:anyAttribute namespace="##any" processContents="skip"/>
    </xs:complexType>

    <xs:complexType name="globalType">
        <xs:group ref="bean:rules"/>
    </xs:complexType>

    <xs:complexType name="propertyType">
        <xs:group ref="bean:rules"/>
        <xs:attribute name="name" use="required"/>
        <xs:attribute name="valid" use="optional" type="bean:trueFalseType"/>
    </xs:complexType>

    <xs:simpleType name="trueFalseType">
        <xs:restriction base="xs:string">
            <xs:enumeration value="true"/>
            <xs:enumeration value="false"/>
        </xs:restriction>
    </xs:simpleType>

    <xs:group name="rules">
        <xs:sequence>
            <xs:element ref="bean:not-null" minOccurs="0" maxOccurs="1"/>
            <xs:element ref="bean:valang" minOccurs="0" maxOccurs="unbounded"/>
            <xs:element ref="bean:ognl" minOccurs="0" maxOccurs="unbounded"/>
            <xs:element ref="bean:in-future" minOccurs="0" maxOccurs="1"/>
            <xs:element ref="bean:in-past" minOccurs="0" maxOccurs="1"/>
            <xs:element ref="bean:email" minOccurs="0" maxOccurs="1"/>
            <xs:element ref="bean:length" minOccurs="0" maxOccurs="1"/>
            <xs:element ref="bean:not-blank" minOccurs="0" maxOccurs="1"/>
            <xs:element ref="bean:not-empty" minOccurs="0" maxOccurs="1"/>
            <xs:element ref="bean:range" minOccurs="0" maxOccurs="1"/>
            <xs:element ref="bean:regexp" minOccurs="0" maxOccurs="1"/>
            <xs:element ref="bean:size" minOccurs="0" maxOccurs="1"/>
            <xs:any namespace="##other" processContents="strict" minOccurs="0" maxOccurs="unbounded"/>
        </xs:sequence>
    </xs:group>

    
    <!-- Validation Rule Elements -->

    <xs:attributeGroup name="ruleCommonAttributes">
        <xs:attribute name="code" type="xs:string" use="optional"/>
        <xs:attribute name="message" type="xs:string" use="optional"/>
        <xs:attribute name="args" type="xs:string" use="optional"/>
        <xs:attribute name="apply-if" type="xs:string" use="optional"/>
    </xs:attributeGroup>

    <xs:element name="valang">
        <xs:complexType>
            <xs:attributeGroup ref="bean:ruleCommonAttributes"/>
            <xs:attribute name="expression" use="required"/>
        </xs:complexType>
    </xs:element>

    <xs:element name="ognl">
        <xs:complexType>
            <xs:attributeGroup ref="bean:ruleCommonAttributes"/>
            <xs:attribute name="expression" use="required"/>
        </xs:complexType>
    </xs:element>

    <xs:element name="in-future">
        <xs:complexType>
            <xs:attributeGroup ref="bean:ruleCommonAttributes"/>
        </xs:complexType>
    </xs:element>

    <xs:element name="in-past">
        <xs:complexType>
            <xs:attributeGroup ref="bean:ruleCommonAttributes"/>
        </xs:complexType>
    </xs:element>

    <xs:element name="email">
        <xs:complexType>
            <xs:attributeGroup ref="bean:ruleCommonAttributes"/>
        </xs:complexType>
    </xs:element>

    <xs:element name="length">
        <xs:complexType>
            <xs:attributeGroup ref="bean:ruleCommonAttributes"/>
            <xs:attribute name="min" use="optional" type="xs:integer"/>
            <xs:attribute name="max" use="optional" type="xs:integer"/>
        </xs:complexType>
    </xs:element>

    <xs:element name="not-blank">
        <xs:complexType>
            <xs:attributeGroup ref="bean:ruleCommonAttributes"/>
        </xs:complexType>
    </xs:element>

    <xs:element name="not-empty">
        <xs:complexType>
            <xs:attributeGroup ref="bean:ruleCommonAttributes"/>
        </xs:complexType>
    </xs:element>

    <xs:element name="not-null">
        <xs:complexType>
            <xs:attributeGroup ref="bean:ruleCommonAttributes"/>
        </xs:complexType>
    </xs:element>

    <xs:element name="range">
        <xs:complexType>
            <xs:attributeGroup ref="bean:ruleCommonAttributes"/>
            <xs:attribute name="min" use="optional" type="xs:integer"/>
            <xs:attribute name="max" use="optional" type="xs:integer"/>
        </xs:complexType>
    </xs:element>

    <xs:element name="regexp">
        <xs:complexType>
            <xs:attributeGroup ref="bean:ruleCommonAttributes"/>
            <xs:attribute name="expression" use="required" type="xs:string"/>
        </xs:complexType>
    </xs:element>

    <xs:element name="size">
        <xs:complexType>
            <xs:attributeGroup ref="bean:ruleCommonAttributes"/>
            <xs:attribute name="min" use="optional" type="xs:integer"/>
            <xs:attribute name="max" use="optional" type="xs:integer"/>
        </xs:complexType>
    </xs:element>

</xs:schema>
